# CIRRUS CONFIGURATION FILE
# https://cirrus-ci.org/guide/writing-tasks/

task: # pinned debian version
  container:
    matrix:
      - image: debian:bullseye-20200327-slim
      - image: debian:bullseye # :latest is too old
  setup_script:
    - apt-get update && apt-get upgrade --yes
    - apt-get install --yes vim shellcheck
  matrix:
    - name: "uname"
      script:
        - uname -a
        - cat /etc/issue
    - name: "Execute .bashrc"
      script:
        - bash ./.bashrc
    - name: "Lint bash scripts"
      script:
        - shellcheck --version
        - shellcheck ./scripts/*.sh

task:
  name: macOS
  osx_instance:
    image: catalina-base # see https://cirrus-ci.org/guide/macOS/
  setup_script:
    - brew install shellcheck
  matrix:
    - name: "uname"
      script:
        - uname -a
    - name: "Execute .bashrc"
      script:
        - bash ./.bashrc
    - name: "Lint bash scripts"
      script:
        - shellcheck --version
        - shellcheck ./scripts/*.sh
